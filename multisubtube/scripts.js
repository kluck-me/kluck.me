var binarySearch,fetchConfSubs,getConfLangParams,getConfVideoId,onPlayerReady,playVideoByConf,renderSubs,setConfLangCodes,setConfVideoUrl,subs,slice=[].slice;binarySearch=function(e,n,t){var a,o,r,i;for(r=0,i=e.length-1;r<=i;)if(o=i+r>>1,(a=t(n,e[o]))>0)r=o+1;else{if(!(a<0))return o;i=o-1}return-r-1},getConfVideoId=function(){var e;return null!=(e=/v=([^=&?]+)/.exec($("#conf-url").val()))?e[1]:void 0},setConfVideoUrl=function(e){$("#conf-url").val(e||"").trigger("input")},getConfLangParams=function(){var e;return e={},$('#conf-subs input[name^="lang-"]').each(function(){var n;(n=$(this)).prop("checked")&&(e[n.val()]=n.data("params"))}),e},setConfLangCodes=function(){var e;e=1<=arguments.length?slice.call(arguments,0):[],$('#conf-subs input[name^="lang-"]').prop("checked",!1),e.forEach(function(e){$('#conf-subs input[name="lang-'+e+'"]').prop("checked",!0)})},fetchConfSubs=function(e,n){var t;return t=getConfLangParams(),pp("langs:",t),$.get({url:"//video.google.com/timedtext",data:{type:"list",v:e},dataType:"xml"}).done(function(a){$("#conf-subs").empty(),$("transcript_list>track",a).each(function(){var n,a,o;o=(a=$(this)).attr("lang_code"),n=$("<div>").addClass("checkbox"),$("<label>").append($("<input>").attr({type:"checkbox",name:"lang-"+o,value:o}).data({params:{name:a.attr("name"),lang:o,v:e}}).prop("checked",!!t[o]),document.createTextNode(a.attr("lang_original"))).appendTo(n),n.appendTo("#conf-subs")}),"function"==typeof n&&n()})},$("#modal-conf").on("show.bs.modal",function(){setConfVideoUrl("undefined"!=typeof player&&null!==player?player.getVideoUrl():void 0)}),$("#conf-url").on("input",function(){var e;e=getConfVideoId(),pp("videoId:",e),e&&fetchConfSubs(e)}),$("#modal-conf form").submit(function(e){e.preventDefault(),e.stopPropagation(),$("#modal-conf").modal("hide"),playVideoByConf()}),subs=[],(renderSubs=function(){var e;player&&player.getCurrentTime&&null!=(e=player.getCurrentTime())&&subs.forEach(function(n,t){var a;a=binarySearch(n,e,function(e,n){return e>n.end?1:e<n.start?-1:0}),$("#sub-"+t).html(a<0?"&nbsp;":n[a].text)}),requestAnimationFrame(renderSubs)})(),onPlayerReady=function(e){var n;e.target,$("#modal-conf").modal("show"),"localhost"===location.hostname&&(n=function(e){return setTimeout(e,500)})(function(){return setConfVideoUrl("https://www.youtube.com/watch?v=sLv6FfHlxmI"),n(function(){return setConfLangCodes("en","ja"),setConfVideoUrl("https://www.youtube.com/watch?v=-sGiE10zNQM"),n(function(){return $("#modal-conf .btn-primary").click()})})})},window.onYouTubeIframeAPIReady=function(){window.player=new YT.Player("ytplayer",{height:"480",width:"853",events:{onReady:onPlayerReady}})},playVideoByConf=function(){var e;$("#subs").empty(),subs.splice(0,subs.length),Object.values(getConfLangParams()).forEach(function(e,n){var t;$("<div>").attr("id","sub-"+n).html("&nbsp;").appendTo("#subs"),t=subs[n]=[],$.get({url:"//video.google.com/timedtext",data:e,dataType:"xml"}).done(function(e){$("transcript>text",e).each(function(){var e,n,a;e=$(this),a=parseFloat(e.attr("start")),n=parseFloat(e.attr("dur")),t.push({start:a,end:a+n,text:e.text()})})})}),e=getConfVideoId(),player.getVideoData().video_id!==e&&player.loadVideoById(e)};