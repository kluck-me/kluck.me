var Novelint,novelint,pp;pp=console.log.bind(console),Novelint=function(){function t(){this.checkers={},this.results=[],this.count=0}return t.match=function(t,n,e){return function(i){var o,r,a,h;for(h=[];a=n.exec(i);)(!e||e(a))&&(o=a.index,r=0,a[2]?(o+=a[1].length,r=a[2].length):a[1]&&(r=a[1].length),h.push([t,o,o+r]));return h}},t.prototype.add=function(t,n){var e;((e=this.checkers)[t]||(e[t]=[])).push(n)},t.prototype.addMatch=function(n,e,i,o){this.add(n,t.match(e,i,o))},t.prototype.check=function(t,n){var e,i,o,r,a,h,c,l,s,u;this.text=t.replace(/\r\n?/g,"\n"),s=[];for(h in this.checkers)if(n[h])for(l=this.checkers[h],i=0,r=l.length;r>i;i++)e=l[i],s=s.concat(e.call(this,this.text));for(c=[],o=0,a=s.length;a>o;o++)u=s[o],c.push([u[0],u[1],u[1]],["end",u[1],u[2]]);return c.sort(function(t,n){return t[2]-n[2]||n[1]-t[1]||("end"===t[0]?1:"end"===n[0]?-1:0)}),this.count=s.length,this.results=c,this},t.prototype.html=function(){var t,n,e,i,o,r;for(r=[],t=0,o=this.results,n=0,e=o.length;e>n;n++)i=o[n],t!==i[2]&&(r.push(this.text.slice(t,i[2])),t=i[2]),"end"===i[0]?r.push("</span>"):r.push('<span class="bg-'+i[0]+'" data-toggle="tooltip" title="エラー">&shy;');return t!==this.text.length&&r.push(this.text.slice(t)),r.join("")},t}(),novelint=new Novelint,novelint.addMatch("indent","danger",/^[^　「『（]/gm,function(t){return"\n"!==t.input.slice(t.index,t.index+1)}),novelint.addMatch("mark-before-close-quote","danger",/([、。])[）』」]/gm),novelint.addMatch("space-after-mark","danger",/([！？])[^　！？）』」\n]/gm),novelint.addMatch("double-mark","danger",/(\u2014+|\u2026+)/gm,function(t){return 2!==t[1].length}),novelint.addMatch("single-mark","danger",/([、。]{2,})/gm),novelint.addMatch("halfwidth-char","warning",/([ -~]+)/gm),novelint.addMatch("fullwidth-char","warning",/([０-９Ａ-Ｚａ-ｚ]+)/gm),novelint.addMatch("extra-space","warning",/(　+)$/gm),novelint.addMatch("extra-space","warning",/([^\n！？])(　+)/gm),$(function(t){var n,e;n=-1,t("#checker").submit(function(){var e;return e={},t(this).find('input[type="checkbox"]').each(function(){e[this.name]=this.checked}),novelint.check(this.text.value,e),t("h2").text(t("h2").text().replace(/\d+/,novelint.count)),t("#result").html(novelint.html()),t('#result [data-toggle="tooltip"]').tooltip(),n=-1,t(".hide").removeClass("hide"),!1}),t("#prev-error").click(function(){var i;return i=t('#result [data-toggle="tooltip"]'),0>=n&&(n=i.length),n--,e(i,n),!1}),t("#next-error").click(function(){var i;return i=t('#result [data-toggle="tooltip"]'),n>=i.length-1&&(n=-1),n++,e(i,n),!1}),e=function(n,e){n.tooltip("hide"),setTimeout(function(){return n.eq(e).tooltip("show")},10),t("html,body").animate({scrollTop:n.eq(e).offset().top-window.innerHeight/2})},"localhost"===location.hostname&&t("#checker").find('[name="text"]').val("　あ　い。う？　え？　\n　お！").end().submit()});