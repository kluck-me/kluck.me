var Novelint,novelint,pp;pp=console.log.bind(console),Novelint=function(){function t(){this.checkers={},this.results=[],this.count=0}return t.match=function(t,e,n){return function(i){var o,r;for(r=[];o=e.exec(i);)(!n||n(o))&&r.push([t,o.index,o.index+(o[1]?o[1].length:0)]);return r}},t.prototype.add=function(t,e){this.checkers[t]=e},t.prototype.addMatch=function(e,n,i,o){this.checkers[e]=t.match(n,i,o)},t.prototype.check=function(t,e){var n,i,o,r,c,h;this.text=t.replace(/\r\n?/g,"\n"),c=[];for(o in this.checkers)e[o]&&(c=c.concat(this.checkers[o].call(this,this.text)));for(r=[],n=0,i=c.length;i>n;n++)h=c[n],r.push([h[0],h[1],h[1]],["end",h[1],h[2]]);return r.sort(function(t,e){return t[2]-e[2]||e[1]-t[1]||("end"===t[0]?1:"end"===e[0]?-1:0)}),this.count=c.length,this.results=r,this},t.prototype.html=function(){var t,e,n,i,o,r;for(r=[],t=0,o=this.results,e=0,n=o.length;n>e;e++)i=o[e],t!==i[2]&&(r.push(this.text.slice(t,i[2])),t=i[2]),"end"===i[0]?r.push("</span>"):r.push('<span class="bg-'+i[0]+'" data-toggle="tooltip" title="エラー">&shy;');return t!==this.text.length&&r.push(this.text.slice(t)),r.join("")},t}(),novelint=new Novelint,novelint.addMatch("indent","danger",/^[^　「『（]/gm,function(t){return"\n"!==t.input.slice(t.index,t.index+1)}),novelint.addMatch("mark-before-close-quote","danger",/([、。])[）』」]/gm),novelint.addMatch("space-after-mark","danger",/([！？])[^　！？）』」]/gm),novelint.addMatch("double-mark","danger",/(\u2014+|\u2026+)/gm,function(t){return 2!==t[1].length}),novelint.addMatch("halfwidth-char","warning",/([ -~]+)/gm),novelint.addMatch("fullwidth-char","warning",/([０-９Ａ-Ｚａ-ｚ]+)/gm),$(function(t){var e,n;e=-1,t("#checker").submit(function(){var n;return n={},t(this).find('input[type="checkbox"]').each(function(){n[this.name]=this.checked}),novelint.check(this.text.value,n),t("h2").text(t("h2").text().replace(/\d+/,novelint.count)),t("#result").html(novelint.html()),t('#result [data-toggle="tooltip"]').tooltip(),e=-1,t(".hide").removeClass("hide"),!1}),t("#prev-error").click(function(){var i;return i=t('#result [data-toggle="tooltip"]'),0>=e&&(e=i.length),e--,n(i,e),!1}),t("#next-error").click(function(){var i;return i=t('#result [data-toggle="tooltip"]'),e>=i.length-1&&(e=-1),e++,n(i,e),!1}),n=function(e,n){e.tooltip("hide"),setTimeout(function(){return e.eq(n).tooltip("show")},10),t("html,body").animate({scrollTop:e.eq(n).offset().top-window.innerHeight/2})}});